<html>
    <head>
        <script src="js/jquery-1.6.4.min.js"></script>
        <style>
            body {
                font-family: "Arial", "Sans-Serif";
                font-size: 10pt;
                overflow: hidden;
				width: 300px;
            }

            #about_pandora_enhancer{
                font-weight: bold;
                padding-top: 10px;
				font-size: 7pt;
				border-top: 1px solid black;
            }

            #pe-settings{
                padding: 5px;
            }

            .settings-title{
                margin-bottom: 0px;
                font-size: 10pt;
                font-weight: bold;
            }
            
            input[type="text"]{
                width: 35px;
                text-align: center;
				margin-right: 10px;
            }

			label{
				font-size: 8pt;
				padding-left: 5px;
			}

			.settings-list{
				margin-left: 10px;
			}

			#settings-notifications, #settings-general{
				padding: 5px;
				border: 1px solid #DADADA;
			}

			.notice{
				color: red;
				font-size: 7pt;
				margin-top: 2px;
			}
        </style>

        <script type="text/javascript">
			var debugLog = function(text)
			{
				if(localStorage['debug_mode'] == "false") return;
				console.log(text);
			};

            var loadCurrentOptions = function()
			{
                //load options and set values
                $("input").each(function(index){
                    var name = $(this).attr("name");
                    var value = localStorage[name];

                    if (value == undefined)
					{
                        debugLog("No setting found, setting default...");
						localStorage[name] = true;

						if(name == 'debug_mode')
						{
							localStorage[name] = false;
						}
						
                        if (name == "notification_timeout")
						{
							localStorage[name] = 3.5;
						}
                    }
                    
                    if (value != "true" || value != "false" && $(this).prop('type') != 'checkbox'){
                        $(this).val(value);
                    } else if (value == "true"){
                        $(this).attr('checked','checked');
                    } else {
                        $(this).prop("checked", false);
                    }             
                });
            };

            $(document).ready(function(){
                loadCurrentOptions();

                $(".setting_checkbox").live('change', function(){
                    var name = $(this).attr("name");
                    var value = $(this).is(":checked");

					console.log(localStorage[name]);

                    debugLog("saving change " + name + ' - ' + value);
                    localStorage[name] = value;
					console.log(localStorage[name]);
                });
                
                $(".setting_textbox").live('change', function(){
                    var name = $(this).attr("name");
                    var value = $(this).val();
                    
                    if (isNaN(value)){
                        alert("Invalid timeout value - use a number this time.");
                        $(this).val('').focus();
                    } else {
                        debugLog("saving change " + name + ' - ' + value);
                        localStorage[name] = value;
                    }
                });
            });
        </script>
    </head>

    <body>
        <div id="pe-settings">
            <form id="settings">
                <div id="settings-general">
                    <div class="settings-title">General</div>
					<div class="settings-list">
						<input class="setting_checkbox" type="checkbox" name="remove_ads"><label for="remove_ads">remove banner ads</label><br />
						<input class="setting_checkbox" type="checkbox" name="remove_videos"><label for="remove_videos">remove video ads</label><br />
						<input class="setting_checkbox" type="checkbox" name="remove_still_listening"><label for="remove_still_listening">skip "Still Listening?" dialog</label><br />
						<input class="setting_checkbox" type="checkbox" name="remove_promobox"><label for="remove_promobox">remove promobox + extend Station List</label><br />
						<input class="setting_checkbox" type="checkbox" name="remove_tooltips"><label for="remove_tooltips">remove tooltips</label><br />
						<input class="setting_checkbox" type="checkbox" name="selectable_lyrics"><label for="selectable_lyrics">selectable/copy lyrics</label><br />
						<input class="setting_checkbox" type="checkbox" name="debug_mode"><label for="debug_mode">debug mode</label>
					</div>
                </div>
                <br />
                <div id="settings-notifications">
                    <div class="settings-title">Notifications</div>
					<div class="settings-list">
						<input class="setting_checkbox" type="checkbox" name="notification_song_change"><label for="notification_song_change">when the song has changed</label><br />
						<input class="setting_checkbox" type="checkbox" name="notification_still_listening"><label for="notification_still_listening">when "Still Listening?" dialog is skipped</label><br />
						<input class="setting_checkbox" type="checkbox" name="notification_video_ad"><label for="notification_video_ad">when a video ad is blocked</label><br /><br />
						<label for="notification_timeout">Display length (seconds):</label><input type="text" class="setting_textbox" name="notification_timeout" maxlength="4">
					</div>
                </div>
            </form>

			<div class="notice">
				** a page refresh is required for changes to take affect.
			</div>
        </div>
		<div id="about_pandora_enhancer">
            Pandora Enhancer (v0.5.8) by Brandon Sachs & Curt Hostetter
        </div>
    </body>
</html>